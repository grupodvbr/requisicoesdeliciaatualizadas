<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Requisi√ß√µes - DEL√çCIA GOURMET</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary: #2563eb;
      --danger: #dc2626;
      --bg: #f3f4f6;
      --surface: #fff;
      --radius: 10px;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: "Segoe UI", sans-serif;
      background: var(--bg);
      padding: 20px;
      display: flex;
      justify-content: center;
    }
    .container {
      background: var(--surface);
      padding: 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      max-width: 650px;
      width: 100%;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: var(--primary);
    }
    label { font-weight: 600; margin-top: 10px; display: block; }
    input, select, textarea {
      width: 100%; padding: 10px; margin-top: 5px;
      border: 1px solid #ccc; border-radius: var(--radius);
    }
    button {
      margin-top: 15px; padding: 12px; border: none;
      border-radius: var(--radius); font-weight: bold;
      cursor: pointer; font-size: 15px; width: 100%;
    }
    .btn-blue { background: var(--primary); color: #fff; }
    .btn-blue:hover { background: #1e40af; }
    .btn-red { background: var(--danger); color: #fff; }
    .btn-red:hover { background: #991b1b; }
    .historico { margin-top: 25px; }
    .card {
      background: #f9fafb; padding: 12px; margin-bottom: 10px;
      border-radius: var(--radius); box-shadow: var(--shadow);
      font-size: 14px;
    }
    .status { font-weight: bold; }
    .status.Processando { color: orange; }
    .status.Enviado { color: green; }
    #msg { text-align:center; margin-top:10px; font-weight:bold; }
  </style>
</head>
<body>
  <div class="container">
    <h2>üìã Requisi√ß√µes DEL√çCIA GOURMET</h2>

    <label>Solicitante</label>
    <select id="solicitante">
      <option value="">Selecione</option>
      <option>ADM</option><option>Ruan</option><option>Renata</option>
      <option>Lu</option><option>Bruna</option><option>Renan</option>
      <option>Raimundo</option><option>Cleide</option><option>Ricardo</option>
      <option>Larissa</option><option>Gabriel</option><option>Valcir</option>
      <option>Tailson</option><option>Dheure</option><option>Dorilson</option>
      <option>Joane</option><option>Neval</option><option>Agnaldo</option>
      <option>Jenison</option><option>Vania</option><option>Adriana</option>
      <option>Helena</option><option>Ivaneide</option><option>Eunice</option>
      <option>Flayane</option><option>Quiteria</option><option>Luzi√¢nia</option>
      <option>Rosemeire</option><option>Wilma</option><option>Islane</option>
      <option>Marcelo</option><option>Juciara</option>
      <option>Aline Santos</option><option>Aline Rodrigues</option>
      <option>Geane</option>
    </select>

    <label>Setor</label>
    <select id="setor">
      <option value="">Selecione</option>
      <option>Cozinha</option><option>Limpeza</option><option>Sushi</option>
      <option>Gar√ßons</option><option>Ger√™ncia</option><option>Pizzaria</option>
      <option>Bar</option><option>Caixa</option><option>Churrasqueira</option>
    </select>

    <label>Produto</label>
    <input type="text" id="item" placeholder="Digite o produto">

    <label>Quantidade</label>
    <input type="number" id="quantidade" min="1">

    <label>Unidade</label>
    <select id="unidade">
      <option value="">Selecione</option>
      <option>UN.</option><option>PC.</option><option>L.</option>
      <option>KG.</option><option>CX.</option>
    </select>

    <label>Observa√ß√µes</label>
    <textarea id="observacoes" placeholder="Observa√ß√µes gerais"></textarea>

    <button class="btn-blue" onclick="enviarItem()">ENVIAR ITEM</button>
    <button class="btn-red" onclick="carregarHistorico()">ATUALIZAR HIST√ìRICO</button>

    <p id="msg"></p>

    <div class="historico">
      <h3>Hist√≥rico</h3>
      <div id="historico"></div>
    </div>
  </div>

<script>
  const URL_GAS = "https://script.google.com/macros/s/AKfycbyXFEAq56G7oQdeCzGw_SdOnQ7XkRPMzBoS1V09Pkk_wI916FGO9nn4e9FfeNmv8KV9KA/exec";

  // üîë Senhas de cada solicitante
  const solicitanteSenhas = {
    "ADM": "00", "Ruan": "Ruan10", "Renata": "Renata12","Flayane": "Flayane5","Eunice": "1097","Helena": "5556",
    "Lu": "Lu26", "Bruna": "Bruna48", "Renan": "Renan78","Raimundo": "Raimundo47",
    "Cleide": "Cleide98","Ricardo": "Ricardo41","Larissa": "Larissa56","Valcir": "Valcir24",
    "Tailson": "Tailson97","Dheure": "Dheure73","Neval": "Neval34","Agnaldo": "Agnaldo67",
    "Jenison": "Genison35","Dorilson": "Dorilson8","Joane": "joane6","Vania": "Vanial86",
    "Adriana": "Adriana49","Ivaneide": "Ivaneide46","Geane": "Geane83","Luzi√¢nia": "Luzi√¢nia8",
    "Rosemeire": "Rosemeire30","Wilma": "Wilma87","Gabriel": "Gabriel5","Islane": "Islane78",
    "Marcelo": "Marcelo75","Juciara": "Juciara35","Aline Santos": "Aline32","Aline Rodrigues": "Aline59",
    "Quiteria": "Quiteria43"
  };

  let senhaAutenticada = false;

  // Valida senha ao selecionar solicitante
  document.getElementById("solicitante").addEventListener("change", () => {
    const s = document.getElementById("solicitante").value;
    if (s) {
      const senha = prompt(`Digite a senha de ${s}:`);
      if (senha === solicitanteSenhas[s]) {
        senhaAutenticada = true;
        document.getElementById("msg").innerText = "‚úÖ Autenticado!";
      } else {
        senhaAutenticada = false;
        document.getElementById("msg").innerText = "‚ùå Senha incorreta!";
        document.getElementById("solicitante").value = "";
      }
    }
  });

  function enviarItem() {
    if (!senhaAutenticada) {
      alert("‚ö†Ô∏è Autentique-se primeiro!");
      return;
    }

    const dados = {
      acao: "cadastrar",
      solicitante: document.getElementById("solicitante").value,
      setor: document.getElementById("setor").value,
      item: document.getElementById("item").value,
      quantidade: document.getElementById("quantidade").value,
      unidade: document.getElementById("unidade").value,
      observacoes: document.getElementById("observacoes").value
    };

    if (!dados.solicitante || !dados.setor || !dados.item || !dados.quantidade || !dados.unidade) {
      alert("‚ö†Ô∏è Preencha todos os campos obrigat√≥rios!");
      return;
    }

    fetch(URL_GAS, {
      method: "POST",
      body: JSON.stringify(dados)
    })
    .then(r => r.text())
    .then(msg => {
      alert(msg);
      limparCampos();
      carregarHistorico();
    });
  }

  function limparCampos() {
    document.getElementById("item").value = "";
    document.getElementById("quantidade").value = "";
    document.getElementById("unidade").value = "";
    document.getElementById("observacoes").value = "";
  }

  function carregarHistorico() {
    fetch(`${URL_GAS}?acao=ler`)
      .then(r => r.json())
      .then(lista => {
        const div = document.getElementById("historico");
        div.innerHTML = "";
        lista.reverse().forEach(l => {
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <div><b>Produto:</b> ${l.item} (${l.qtd} ${l.unidade})</div>
            <div><b>Setor:</b> ${l.setor}</div>
            <div><b>Solicitante:</b> ${l.solicitante}</div>
            <div><b>Obs:</b> ${l.observacoes || "-"}</div>
            <div><b>Data:</b> ${l.dataHora}</div>
            <div class="status ${l.status}">Status: ${l.status}</div>
          `;
          div.appendChild(card);
        });
      });
  }

  carregarHistorico();
</script>
</body>
</html>
